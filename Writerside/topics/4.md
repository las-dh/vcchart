# 프로토타입 1호 사례

## 통으로 한 번에 그리기

차트를 직접 Compose로 개발하기로 결정한 후  
가장 먼저 진행한 방법이다.  

성능에 문제가 있었던 방법으로 혈당 데이터가 많아질수록 Compose Canvas의 가로 크기가 커지며  
차트를 매번 모두 그리기 때문에 스크롤 할 수 있는 기간을 길게 잡을수록 속도가 느려졌다.  

OpenGl과 달리 포인트의 개수는 생각보다 성능에 매우 많은 영향이 있었다.  
OpenGl의 경우 랜더링 파이프라인을 통해 정점들을 하드웨어의 성능을 최대한 끌어내어 처리하고  
백버퍼에 저장했다가 화면에 보여줄때 한 번의 드로우 콜로 그리는 반면, Compose는 Path를 이용해  
하나의 Line을 만들긴 하지만 그 과정 자체가 성능을 저하시켰다.  

또한, 확대, 축소하거나 보이는 관점을 바꿨을 때 OpenGl의 경우는 이미 하드웨어에 저장된 정점들을  
어떻게 화면에 보일지만 계산하는 과정이 따로 있기 때문에 불필요하게 다시 선을 만들거나  
배치하는 과정이 없는데 Compose는 그렇지 않기 때문에 새로 계산한다.  

따라서 OpenGl에서는 정점이 몇십만개, 몇백만개가 되어도 적절하게 처리만하면  
성능에 문제가 없었던 경험이 Compose에서는 통하지 않았다.  

통으로 그렸을 때의 장점은 계산이 단순해지고, 하나의 Canvas 좌표계만 생각하면 되기 때문에  
스크롤과 핀치줌같은 인터렉션을 처리하기가 쉬워진다.  
또한, 선을 그릴때 복잡한 연결성을 생각하지 않아도 된다.  
하지만 치명적인 단점은 성능이였다. 하나의 Canvas에 모든것을 그리기 때문에  
줌의 배율이 바뀌거나, 날짜에 연관된 계산이 필요하고 그에 따라 형태를 바꿔야할때는  
모든 연산을 새로해야만 한다.  
최대 혈당값에 따라서 Y축 범례가 바껴야한다거나  
타임라인의 간격이 바껴야해서 새로 그릴때 성능저하가 매우 심했다.  

따라서 2022년 12월 프로토타입 영상 시연을 끝으로  
프로토타입 1호는 실패했다고 생각하여 개선방법을 찾아보기로 했다.  
